import{_ as F}from"./week3.70dc6bd0.js";import{e as M,g as c,i as g,j as a,Q as T,q as w,A as B,r as S,I as $,d as U,a as q,C as z,k as h,l as y,v as N,t as m,u as o,F as C,m as I,s as Q,D as X,E as Y}from"./entry.950a9e27.js";import{_ as K}from"./Card.2e12866b.js";import{u as Z}from"./cookie.68603f12.js";import{l as O}from"./loading.acca26de.js";import{g as P,h as tt,b as et,c as ot,d as st,e as at}from"./works.8b9c14c6.js";import{a as nt}from"./dropdowns.e444908b.js";import"./useCustomFetch.e7fcaaf5.js";import"./fetch.6d0ababc.js";const rt={class:"dropdown"},dt={class:"btn bg-transparent border-0 text-white dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},it=M({__name:"Dropdown",props:{dropdownHeight:{type:Boolean,default:!1},dropdownMenu:{default:()=>[]}},setup(f){return(i,l)=>(c(),g("div",rt,[a("button",dt,[T(i.$slots,"name",{},void 0,!0)]),a("ul",{class:w(["dropdown-menu",[{"dropdown-height":i.dropdownHeight},...i.dropdownMenu]])},[T(i.$slots,"dropdown-item",{},void 0,!0)],2)]))}});const lt=B(it,[["__scopeId","data-v-5635c611"]]),pt=""+new URL("作品列表.336140bc.svg",import.meta.url).href,ut=f=>{const i=JSON.parse(JSON.stringify(f));return Object.keys(i).forEach(l=>{(i[l]===0||i[l]===""||i[l]==="0")&&delete i[l]}),Object.entries(i).map(l=>l.join("=")).join("&")},G=f=>(X("data-v-42971672"),f=f(),Y(),f),_t={class:"bg-dark"},ct={class:"container text-white"},gt={class:"py-7"},mt=G(()=>a("h1",{class:"border-start border-white border-5 ps-4 mb-4"},[a("img",{src:pt,alt:"作品列表"})],-1)),wt={class:"row justify-content-end"},vt={class:"col-md-12"},kt={class:"d-flex justify-content-start justify-content-md-end flex-wrap"},yt=["data-type-id"],ft=["data-stage-id","data-stage-name"],bt={key:0,class:"d-flex"},ht=["data-sort-name","data-name"],Nt=["data-tag-id","data-tag-name"],St=G(()=>a("div",{id:"gtmUse"},null,-1)),Ut={class:"mt-md-0 mt-3"},xt={key:0},Ct={class:"row"},It={class:"d-flex justify-content-center"},Ot={key:1,class:"h-100vh"},Jt=M({__name:"index",setup(f){const i=S({dropdowns:{works_types:[],stages:[],stage_schedule:[],creative_commons:[],medals:[]}}),l=S({works_group_list:{all:100,1:10,2:20,3:30,4:40}}),v=S({works_list:[],pagination:{total_works:13,count:18,total_page:1,current_page:1}}),J=S(1),n=$({works_type_id:0,stage_id:0,sort_by:"",tag_id:0}),x=O(async(s,e)=>{const r=ut(e),{data:p,error:k}=await P(s,r);if(k.value)throw k.value=null,new Error("取得作品列表失敗。");v.value=p.value}),u=$({worksName:U(()=>{var s;return((s=V.value.filter(e=>e.id===Number(n.works_type_id))[0])==null?void 0:s.name)||"全部組別"}),worksNum:U(()=>u.worksName==="全部組別"?l.value.works_group_list.all:l.value.works_group_list[n.works_type_id]?l.value.works_group_list[n.works_type_id]:0),stageName:"關卡",sortName:"排序",sorts:U(()=>i.value.dropdowns.works_types.filter(s=>s.id===Number(n.works_type_id))[0].sorts),tagName:"Tags",tags:U(()=>i.value.dropdowns.works_types.filter(s=>s.id===Number(n.works_type_id))[0].tags),childData:{}}),R={"個人組-前端":"前端個人組","個人組-UI":"UI 設計個人組","團體組-UI":"團體組 UI","團體組-前端":"團體組 前端"},V=U(()=>i.value.dropdowns.works_types.map(s=>({id:s.id,name:R[s.name],sorts:s.sorts,tags:s.tags})));(async()=>{const[s,e,r]=await Promise.all([nt(),tt(),P()]);if(s.error.value||e.error.value||r.error.value)throw s.error.value=null,e.error.value=null,r.error.value=null,new Error("取得資料失敗。");i.value=s.data.value,l.value=e.data.value,v.value=r.data.value,sessionStorage.getItem("HbPeShUserVmYTyPe")==="個人組/前端工程師"&&(J.value=2)})();const W=s=>{const e=Number(s.dataset.typeId);e===0&&(n.sort_by="",n.tag_id=0),n.works_type_id=e},D=s=>{const{stageId:e,stageName:r}=s.dataset;n.stage_id=e,u.stageName=r},L=s=>{const{sortName:e,name:r}=s.dataset;n.sort_by=r,u.sortName=e},j=s=>{const{tagId:e,tagName:r}=s.dataset;n.tag_id=e,u.tagName=r},A=O(async(s,e)=>{var k,b,t,_;let r=!1,p="更新作品按讚失敗。";if(e){const{error:d}=await et(s);d.value&&(p=JSON.parse(JSON.stringify((b=(k=d.value)==null?void 0:k.data)==null?void 0:b.message)),d.value=null,r=!0)}else{const{error:d}=await ot(s);d.value&&(p=JSON.parse(JSON.stringify((_=(t=d.value)==null?void 0:t.data)==null?void 0:_.message)),d.value=null,r=!0)}if(r)throw new Error(p);await x(v.value.pagination.current_page,n)}),H=O(async(s,e)=>{var k,b,t,_;let r=!1,p="採用功能尚未開放。";if(e){const{error:d}=await st(s);d.value&&(p=JSON.parse(JSON.stringify((b=(k=d.value)==null?void 0:k.data)==null?void 0:b.message)),d.value=null,r=!0)}else{const{error:d}=await at(s);d.value&&(p=JSON.parse(JSON.stringify((_=(t=d.value)==null?void 0:t.data)==null?void 0:_.message)),d.value=null,r=!0)}if(r)throw new Error(p);await x(v.value.pagination.current_page,n)}),E=S(!1);return q(()=>{Z("t_sInR5cCI6IkpXVCJ_token").value&&(E.value=!0)}),(s,e)=>{const r=F,p=lt,k=K,b=z("VueAwesomePaginate");return c(),g("div",_t,[a("div",ct,[a("div",gt,[h(r),mt,a("div",wt,[a("div",vt,[a("div",kt,[h(p,{"dropdown-menu":["p-4"]},{name:y(()=>[N(m(o(u).worksName)+" ",1),a("span",{class:w(["badge rounded-pill",o(n).works_type_id!==0?"dropdown-item-badge":"dropdown-item-badge-action"])},m(o(u).worksNum),3)]),"dropdown-item":y(()=>[a("li",null,[a("button",{type:"button",class:w(["dropdown-item rounded py-2",o(n).works_type_id===0?"active":""]),"data-type-id":0,onClick:e[0]||(e[0]=t=>W(t.target))},[N(" 全部組別 "),a("span",{class:w(["badge rounded-pill",o(n).works_type_id!==0?"dropdown-item-badge":"dropdown-item-badge-action"])},m(o(l).works_group_list.all),3)],2)]),(c(!0),g(C,null,I(o(V),(t,_)=>(c(),g("li",{key:_},[a("button",{type:"button",class:w(["dropdown-item rounded py-2",o(n).works_type_id===t.id?"active":""]),"data-type-id":t.id,onClick:e[1]||(e[1]=d=>W(d.target))},[N(m(t.name)+" ",1),a("span",{class:w(["badge rounded-pill",o(n).works_type_id===t.id?"dropdown-item-badge":"dropdown-item-badge-action"])},m(o(l).works_group_list[t.id]?o(l).works_group_list[t.id]:0),3)],10,yt)]))),128))]),_:1}),h(p,{"dropdown-menu":["p-4"]},{name:y(()=>[N(m(o(u).stageName),1)]),"dropdown-item":y(()=>[a("li",null,[a("button",{class:w(["dropdown-item rounded py-2",o(n).stage_id==="0"?"active":""]),type:"button","data-stage-id":"0","data-stage-name":"關卡",onClick:e[2]||(e[2]=t=>D(t.target))}," 全部關卡 ",2)]),(c(!0),g(C,null,I(o(i).dropdowns.stages,(t,_)=>(c(),g("li",{key:`stages-${_}`},[a("button",{class:w(["dropdown-item rounded py-2",o(n).stage_id===String(t.id)?"active":""]),type:"button","data-stage-id":t.id,"data-stage-name":`Mission${t.id}`,onClick:e[3]||(e[3]=d=>D(d.target))}," Mission"+m(t.id)+" - "+m(t.name),11,ft)]))),128))]),_:1}),o(n).works_type_id?(c(),g("div",bt,[h(p,{"dropdown-menu":["p-4"]},{name:y(()=>[N(m(o(u).sortName),1)]),"dropdown-item":y(()=>[a("li",null,[a("button",{class:w(["dropdown-item rounded py-2",o(u).sortName==="排序"?"active":""]),type:"button","data-sort-name":"排序","data-name":"",onClick:e[4]||(e[4]=t=>L(t.target))}," 預設排序 ",2)]),(c(!0),g(C,null,I(o(u).sorts,(t,_)=>(c(),g("li",{key:_},[a("button",{class:w(["dropdown-item rounded py-2",o(u).sortName===t.cht_name?"active":""]),type:"button","data-sort-name":t.cht_name,"data-name":t.name,onClick:e[5]||(e[5]=d=>L(d.target))},m(t.cht_name),11,ht)]))),128))]),_:1}),h(p,{"dropdown-height":!0,"dropdown-menu":["p-4"]},{name:y(()=>[N(m(o(u).tagName),1)]),"dropdown-item":y(()=>[a("li",null,[a("button",{class:w(["dropdown-item rounded py-2",o(n).tag_id===0?"active":""]),type:"button","data-tag-id":"0","data-tag-name":"Tags",onClick:e[6]||(e[6]=t=>j(t.target))}," 全部 Tags ",2)]),(c(!0),g(C,null,I(o(u).tags,t=>(c(),g("li",{key:t.id},[a("button",{class:w(["dropdown-item rounded py-2",o(n).tag_id===String(t.id)?"active":""]),type:"button","data-tag-id":t.id,"data-tag-name":t.name,onClick:e[7]||(e[7]=_=>j(_.target))},m(t.name),11,Nt)]))),128))]),_:1})])):Q("",!0),a("button",{type:"button",class:"btn btn-info text-white",onClick:e[8]||(e[8]=t=>o(x)(1,o(n)))}," 搜尋 "),St])])]),a("div",Ut,[o(v).works_list.length?(c(),g("div",xt,[a("div",Ct,[h(k,{"works-list":o(v).works_list,"user-type":o(J),"auth-status":o(E),onIsUpvotes:o(A),onIsUse:o(H)},null,8,["works-list","user-type","auth-status","onIsUpvotes","onIsUse"])]),a("div",It,[h(b,{modelValue:o(v).pagination.current_page,"onUpdate:modelValue":e[9]||(e[9]=t=>o(v).pagination.current_page=t),"total-items":o(v).pagination.total_works,"items-per-page":o(v).pagination.count,"on-click":t=>o(x)(t,o(n)),"pagination-container-class":"pagination","prev-button-content":"«","next-button-content":"»","paginate-buttons-class":"page-link","active-page-class":"active"},null,8,["modelValue","total-items","items-per-page","on-click"])])])):(c(),g("p",Ot," 暫時沒有作品內容 "))])])])])}}});const Bt=B(Jt,[["__scopeId","data-v-42971672"]]);export{Bt as default};
