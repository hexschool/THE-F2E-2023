import{_ as N}from"./Alert.8d2ed0f2.js";import{_ as R}from"./SideBar.85ea5694.js";import{_ as H}from"./client-only.77fcb457.js";import{l as G}from"./loading.acca26de.js";import{n as J,o as K,d as Q,k as W}from"./users.810791e2.js";import{e as O,r as v,w as X,f as q,C as F,g as _,i as m,k as t,u as s,j as e,q as p,s as S,l as E,t as b,F as Y,m as Z,D as ee,E as oe,A as te}from"./entry.950a9e27.js";import"./useUploadImg.7d2a983e.js";import"./fetch.6d0ababc.js";import"./works.8b9c14c6.js";import"./useCustomFetch.e7fcaaf5.js";import"./cookie.68603f12.js";import"./team.297d1263.js";const n=l=>(ee("data-v-cea8484d"),l=l(),oe(),l),se={class:"col-md-8"},ae={id:"myTab",class:"nav border-0",role:"tablist"},ie={key:0,class:"nav-item",role:"presentation"},ne=n(()=>e("span",null,"修改團體資料",-1)),le=[ne],de={class:"nav-item",role:"presentation"},re=n(()=>e("span",null,"修改個人資料",-1)),ce=[re],_e=n(()=>e("li",{class:"nav-item",role:"presentation"},[e("button",{id:"resetPassword-tab",class:"nav-link nav-link-border text-white","data-bs-toggle":"tab","data-bs-target":"#resetPassword",type:"button",role:"tab","aria-controls":"resetPassword","aria-selected":"false"},[e("span",null,"變更密碼")])],-1)),me={id:"myTabContent",class:"mt-4 tab-content bg-white-40 p-7 rounded-4 text-white"},ue=n(()=>e("h2",{class:"fs-3 mb-4"}," 修改團體資料 ",-1)),pe={key:0,class:"mt-5"},fe={class:"mb-3"},be={key:0},ve=n(()=>e("p",{class:"mb-0"}," 組長： ",-1)),we={key:0,class:"mb-0"},he=["href"],ke={class:"text-white"},ye={key:1},ge=n(()=>e("p",{class:"mb-0"}," 組員： ",-1)),xe={class:"mb-0"},Ve=["href"],Ee={class:"text-white"},Pe={key:2},Ce=n(()=>e("p",{class:"mb-0"}," 尚未註冊 F2E 系統的組員： ",-1)),Ue={class:"mb-0"},Ie=n(()=>e("h2",{class:"fs-3 mb-4"}," 修改個人資料 ",-1)),Fe={class:"mt-5"},Se={class:"mb-4"},Me=n(()=>e("label",{for:"description",class:"form-label"},"個人簡介（限制 150 字）",-1)),$e={class:"mb-4"},Ae=n(()=>e("label",{for:"fb_link",class:"form-label"},"Facebook 個人連結",-1)),je=["disabled"],Be=n(()=>e("hr",null,null,-1)),De={id:"resetPassword",class:"tab-pane fade",role:"tabpanel","aria-labelledby":"reset_password-tab"},Ge=n(()=>e("h2",{class:"fs-3"}," 變更密碼 ",-1)),Ne={class:"my-4"},Oe=n(()=>e("label",{for:"old_password",class:"form-label"},"舊密碼",-1)),qe={class:"mb-4"},Te=n(()=>e("label",{for:"old_password",class:"form-label"},"新密碼",-1)),ze={class:"mb-4"},Le=n(()=>e("label",{for:"confirm_password",class:"form-label"},"確認新密碼",-1)),Re=["disabled"],He=O({__name:"Edit",props:{info:{default:()=>({avatar:null,description:null,email:"",facebook_url:null,individual_competition:null,medal_image_url:null,medal_name:null,nickname:"",user_id:""}),type:Object}},emits:["edit"],async setup(l,{emit:P}){let k,h;const w=l,d=v({description:"",facebook_url:""}),u=v({old_password:"",new_password:"",confirm_new_password:""}),c=v({individual_competition_id:1,position_id:1,email:""}),y=v([]),U=v([]),g=v({content:"",style:"",icon:""}),I=P,M=()=>{g.value={style:"success",icon:"check_circle",content:"已更新成功！"}},$=o=>{g.value={style:"danger",icon:"error",content:o.response.data.message||"更新失敗！"}},A=G(async()=>{Object.keys(d.value).forEach(o=>{d.value[o]===""&&delete d.value[o]});try{const{error:o}=await J(d.value);o.value&&(o.value=null),I("edit"),M()}catch(o){$(o)}}),j=G(async()=>{try{const{error:o}=await K(u.value);o.value&&(o.value=null),M()}catch(o){$(o)}}),T=async()=>{try{const{data:o,error:a}=await Q();a.value&&(a.value=null),y.value=o.value.individual_competitions,U.value=o.value.team_competition_positions}catch{}},B=o=>{d.value.description=o.description?o.description:"",d.value.facebook_url=o.facebook_url?o.facebook_url:"",o.individual_competition&&(o.individual_competition.name.split("/")[1]==="前端工程師"?c.value.individual_competition_id=2:c.value.individual_competition_id=1),o.team_competition&&(o.team_competition.position_name==="UI設計師"&&(c.value.position_id=1),o.team_competition.position_name==="前端工程師"&&(c.value.position_id=2),o.team_competition.position_name==="其他"&&(c.value.position_id=3))};X(()=>w.info,()=>{B(w.info)},{deep:!0});const z=async()=>{var o;await T(),(o=w.info)!=null&&o.user_id&&B(w.info)};return[k,h]=q(()=>z()),await k,h(),(o,a)=>{const L=N,C=H,x=F("VField"),V=F("VErrorMessage"),D=F("VForm");return _(),m("div",se,[t(L,{message:s(g)},null,8,["message"]),e("ul",ae,[l.info.team_competition?(_(),m("li",ie,[e("button",{id:"teamProfile-tab",class:p(["nav-link nav-link-border text-white",{active:l.info.team_competition}]),"data-bs-toggle":"tab","data-bs-target":"#teamProfile",type:"button",role:"tab","aria-controls":"teamProfile","aria-selected":"true"},le,2)])):S("",!0),e("li",de,[e("button",{id:"profile-tab",class:p(["nav-link nav-link-border text-white",{active:!l.info.team_competition}]),"data-bs-toggle":"tab","data-bs-target":"#profile",type:"button",role:"tab","aria-controls":"profile","aria-selected":"false"},ce,2)]),_e]),e("div",me,[e("div",{id:"teamProfile",class:p(["tab-pane fade",{"show active":l.info.team_competition}]),role:"tabpanel","aria-labelledby":"teamProfile-tab"},[ue,t(C,null,{default:E(()=>[l.info.team_competition?(_(),m("div",pe,[e("p",fe," 團隊名稱："+b(l.info.team_competition.name),1),(_(!0),m(Y,null,Z(l.info.team_competition.members,(i,f)=>(_(),m("div",{key:"member"+f,class:"mb-4"},[i.is_leader?(_(),m("div",be,[ve,i.nickname?(_(),m("p",we,[e("a",{target:"_blank",href:"/users/"+i.user_id,class:"text-white"},b(i.nickname)+" / "+b(i.position_name),9,he),e("span",ke," ( "+b(i.is_verify?"驗證成功":"尚未完成信箱驗證")+" )",1)])):S("",!0)])):i.nickname?(_(),m("div",ye,[ge,e("p",xe,[e("a",{target:"_blank",href:"/users/"+i.user_id,class:"text-white"},b(i.nickname)+" / "+b(i.position_name),9,Ve),e("span",Ee,"( "+b(i.is_verify?"驗證成功":"尚未完成信箱驗證")+" )",1)])])):(_(),m("div",Pe,[Ce,e("p",Ue,b(i.email),1)]))]))),128))])):S("",!0)]),_:1})],2),e("div",{id:"profile",class:p(["tab-pane fade",{"show active":!l.info.team_competition}]),role:"tabpanel","aria-labelledby":"profile-tab"},[Ie,t(C),e("div",Fe,[t(C,null,{default:E(()=>[t(D,null,{default:E(({meta:i,errors:f})=>[e("div",Se,[Me,t(x,{id:"description",modelValue:s(d).description,"onUpdate:modelValue":a[0]||(a[0]=r=>s(d).description=r),modelModifiers:{trim:!0},as:"textarea",name:"description",label:"個人簡介",class:p(["form-control",{"is-invalid":f.description}]),rules:"max:150",rows:"3"},null,8,["modelValue","class"]),t(V,{name:"description",class:"invalid-feedback"})]),e("div",$e,[Ae,t(x,{id:"fb_link",modelValue:s(d).facebook_url,"onUpdate:modelValue":a[1]||(a[1]=r=>s(d).facebook_url=r),modelModifiers:{trim:!0},name:"fb_link",type:"text",label:"Facebook 個人連結",class:p(["form-control",{"is-invalid":f.fb_link}]),rules:{regex:new RegExp("(?:(?:http|https)://)?(?:www.)?facebook.com/\\w*")},placeholder:"https://www.facebook.com/"},null,8,["modelValue","class","rules"]),t(V,{name:"fb_link",class:"invalid-feedback"})]),e("button",{type:"button",class:"btn btn-info text-white rounded-0",disabled:!i.valid,onClick:a[2]||(a[2]=(...r)=>s(A)&&s(A)(...r))}," 更新資訊 ",8,je)]),_:1})]),_:1})]),Be],2),e("div",De,[Ge,t(C,null,{default:E(()=>[t(D,null,{default:E(({meta:i,errors:f})=>[e("div",Ne,[Oe,t(x,{id:"old_password",modelValue:s(u).old_password,"onUpdate:modelValue":a[3]||(a[3]=r=>s(u).old_password=r),modelModifiers:{trim:!0},name:"old_password",type:"password",label:"舊密碼",class:p(["form-control",{"is-invalid":f.old_password}]),rules:"password"},null,8,["modelValue","class"]),t(V,{name:"old_password",class:"invalid-feedback"})]),e("div",qe,[Te,t(x,{id:"password",modelValue:s(u).new_password,"onUpdate:modelValue":a[4]||(a[4]=r=>s(u).new_password=r),modelModifiers:{trim:!0},name:"password",type:"password",label:"新密碼",class:p(["form-control",{"is-invalid":f.password}]),rules:"password"},null,8,["modelValue","class"]),t(V,{name:"password",class:"invalid-feedback"})]),e("div",ze,[Le,t(x,{id:"confirm_password",modelValue:s(u).confirm_new_password,"onUpdate:modelValue":a[5]||(a[5]=r=>s(u).confirm_new_password=r),modelModifiers:{trim:!0},name:"confirm_password",type:"password",label:"確認新密碼",class:p(["form-control",{"is-invalid":f.confirm_password}]),rules:"required|confirmed:@password"},null,8,["modelValue","class"]),t(V,{name:"confirm_password",class:"invalid-feedback"})]),e("button",{type:"button",class:"btn btn-info text-white rounded-0",disabled:!i.valid,onClick:a[6]||(a[6]=(...r)=>s(j)&&s(j)(...r))}," 更新密碼 ",8,Re)]),_:1})]),_:1})])])])}}});const Je=te(He,[["__scopeId","data-v-cea8484d"]]),Ke={class:"main-bg"},Qe={class:"container py-5"},We={class:"row justify-content-center"},Xe={class:"col-lg-8 col-10"},Ye={class:"row justify-content-center mt-md-7"},mo=O({__name:"index",async setup(l){let P,k;const h=v({avatar:null,description:null,email:"",facebook_url:null,medal_image_url:null,medal_name:null,nickname:"",user_id:""}),w=v({content:"",style:"",icon:""}),d=async()=>{try{const{data:c,error:y}=await W();if(y.value)throw y.value=null,new Error("取得使用者資料失敗。");h.value=c.value.user_info}catch(c){console.log(c)}},u=c=>{w.value=c};return[P,k]=q(()=>d()),await P,k(),(c,y)=>{const U=N,g=R,I=Je;return _(),m("div",Ke,[e("div",Qe,[e("div",We,[e("div",Xe,[t(U,{message:s(w)},null,8,["message"])])]),e("div",Ye,[t(g,{info:s(h),onEdit:d,onAlert:u},null,8,["info"]),t(I,{info:s(h),onEdit:d},null,8,["info"])])])])}}});export{mo as default};
